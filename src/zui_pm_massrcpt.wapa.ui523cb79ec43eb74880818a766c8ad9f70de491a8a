sap.ui.define([                                                                                                                                                                                                                                                
    "com/toray/massreceipt/controller/BaseController",                                                                                                                                                                                                         
    "sap/ui/core/Fragment",                                                                                                                                                                                                                                    
    "sap/m/Token",                                                                                                                                                                                                                                             
    "sap/m/MessageBox",                                                                                                                                                                                                                                        
    "sap/ui/model/odata/v2/ODataListBinding"                                                                                                                                                                                                                   
],                                                                                                                                                                                                                                                             
    /**                                                                                                                                                                                                                                                        
     *&nbsp;                                                                                                                                                                                                                                                   
     * @param {*} BaseController&nbsp;                                                                                                                                                                                                                         
     * @param {*} Fragment&nbsp;                                                                                                                                                                                                                               
     * @param {*} Token&nbsp;                                                                                                                                                                                                                                  
     * @returns&nbsp;                                                                                                                                                                                                                                          
     */                                                                                                                                                                                                                                                        
    function (BaseController, Fragment, Token, MessageBox, ODataListBinding) {                                                                                                                                                                                 
        "use strict";                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
        return BaseController.extend("com.toray.massreceipt.controller.Movement", {                                                                                                                                                                            
                                                                                                                                                                                                                                                               
            onInit: function () {                                                                                                                                                                                                                              
                BaseController.prototype.onInit.call(this);                                                                                                                                                                                                    
                this.getRouter().getRoute("RouteMovement").attachMatched(this._onRouteSelectOrder, this);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp+
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                    
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            /**                                                                                                                                                                                                                                                
             * Handles the event when a route is selected for order.                                                                                                                                                                                           
             *                                                                                                                                                                                                                                                 
             * @param {Object} oEvent - The event object.                                                                                                                                                                                                      
             * @return {Promise<void>} A promise that resolves when the function completes.                                                                                                                                                                    
             */                                                                                                                                                                                                                                                
            _onRouteSelectOrder: async function(oEvent){                                                                                                                                                                                                       
                if (this.getOwnerComponent().getSelectionChanged()===true){ //If selection changed from other screen (ItemsList) then generate new table                                                                                                       
                    this.removeAllMessages();                                                                                                                                                                                                                  
                    this.generateMovmentTableItems();                                                                                                                                                                                                          
                    this.getOwnerComponent().setSelectionChanged(false);                                                                                                                                                                                       
                }                                                                                                                                                                                                                                              
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            /**                                                                                                                                                                                                                                                
             * Generate movements table                                                                                                                                                                                                                        
             * @returns&nbsp;                                                                                                                                                                                                                                  
             */                                                                                                                                                                                                                                                
            generateMovmentTableItems: async function () {&nbsp;                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                const oTable = this.byId("MovementsTable");                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
                oTable.destroyItems();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                         
                this.getModel().resetChanges(null, true, true);&nbsp;                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                const aSelectedItemsContexts = this.getOwnerComponent().getSelectedItemsContexts();                                                                                                                                                            
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
                if(aSelectedItemsContexts==null||aSelectedItemsContexts?.length==0){                                                                                                                                                                           
                    this.getRouter().navTo("RouteItemsList", null,null,true);                                                                                                                                                                                  
                    return;                                                                                                                                                                                                                                    
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                this.setModel(this.getModel(), "POItem");                                                                                                                                                                                                      
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
                const oItemTemplate = await Fragment.load({ name: "com.toray.massreceipt.view.fragments.GoodReceiptColumnListItem", controller: this });                                                                                                       
                this.getView().addDependent(oItemTemplate);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                    
                                                                                                                                                                                                                                                               
                aSelectedItemsContexts.forEach(async itemContext => {                                                                                                                                                                                          
                    //Create good movement entries, one movement for each selected item.                                                                                                                                                                       
                    let oGoodMovementContext = this.getModel().createEntry("/GoodMovement", { properties: { PurchasingDocumentNumber: itemContext.getProperty("PurchaseOrder"),                                                                                
                                                                                                            ItemNumber: itemContext.getProperty("PurchaseOrderItem"),                                                                                          
                                                                                                            DisplayCurrency: itemContext.getProperty("DisplayCurrency") } });                                                                                  
                    this.getModel().setProperty("EntityPath", oGoodMovementContext.getPath(), oGoodMovementContext);                                                                                                                                           
                                                                                                                                                                                                                                                               
                    //Set default values from PO Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                            
                    const defaultProperties = {                                                                                                                                                                                                                
                        Quantity: itemContext.getProperty("DefaultQuantity"),                                                                                                                                                                                  
                        UnitOfMeasure: itemContext.getProperty("PurchaseOrderQuantityUnit"),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+
&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                                                             
                        PostingDate: new Date(),                                                                                                                                                                                                               
                        DocumentDate: new Date(),                                                                                                                                                                                                              
                        Plant: itemContext.getProperty("Plant"),                                                                                                                                                                                               
                        StorageLocation: itemContext.getProperty("StorageLocation"),                                                                                                                                                                           
                        BatchNumber: itemContext.getProperty("Batch"),                                                                                                                                                                                         
                        ValuationType: itemContext.getProperty("ValuationType"),                                                                                                                                                                               
                        Created: false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                         
                    };                                                                                                                                                                                                                                         
                    Object.entries(defaultProperties).forEach(([key, value]) => {                                                                                                                                                                              
                        this.getModel().setProperty(key, value, oGoodMovementContext);                                                                                                                                                                         
                    });                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                    //Generate a line item in the table for each selected PO item                                                                                                                                                                              
                    //const oItem = await Fragment.load({ name: "com.toray.massreceipt.view.fragments.GoodReceiptColumnListItem", controller: this });                                                                                                         
                    const oItem = oItemTemplate.clone();                                                                                                                                                                                                       
                    oTable.addItem(oItem);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n+
bsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                                                   
                    oItem.bindElement(oGoodMovementContext.getPath());&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                 
                    oItem.setBindingContext(itemContext, "POItem");                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                    const oSerialNumbersMultiInput = oItem.getCells().find(element=>element.getMetadata().getName()==="sap.m.MultiInput");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n+
bsp;                                                                                                                                                                                                                                                           
                    oSerialNumbersMultiInput.addValidator( args => new Token({ key: args.text, text: args.text }));                                                                                                                                            
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                       
                });                                                                                                                                                                                                                                            
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            onPerformGoodReceipt: function(oEvent){                                                                                                                                                                                                            
                this.executeGoodReceipt();                                                                                                                                                                                                                     
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            /**                                                                                                                                                                                                                                                
             * Executes the good receipt process.                                                                                                                                                                                                              
             *                                                                                                                                                                                                                                                 
             */                                                                                                                                                                                                                                                
            executeGoodReceipt: function () {                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                MessageBox.confirm(this.getResourceText("msg.goodreceipt.confirm", null), {                                                                                                                                                                    
                    actions: [MessageBox.Action.YES, MessageBox.Action.NO],                                                                                                                                                                                    
                    onClose: async (sResult)=>{                                                                                                                                                                                                                
                        if (sResult === MessageBox.Action.YES) {                                                                                                                                                                                               
                            const oTable = this.byId("MovementsTable");                                                                                                                                                                                        
                            const aItems = oTable.getItems();                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                            try {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp+
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                            
                                aItems.forEach(item=>{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                             
                                    const oGoodMovementContext = item.getBindingContext();&nbsp;                                                                                                                                                               
                                                                                                                                                                                                                                                               
                                    //Retrieve the serial numbers from the MultiInput control.&nbsp;                                                                                                                                                           
                                    //As the OData model is not updated automatically with this control, we need to do it programmatically.                                                                                                                    
                                    const oSerialNumbersMultiInput = item.getCells().find(element=>element.getMetadata().getName()==="sap.m.MultiInput");&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp+
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                        
                                    const aTokens = oSerialNumbersMultiInput?.getTokens();                                                                                                                                                                     
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n+
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                           
                                    const serialNumbersListBinding = new ODataListBinding(this.getModel(), "serialNumbers", oGoodMovementContext);                                                                                                             
                                    serialNumbersListBinding.getAllCurrentContexts()?.forEach(context => context.delete()); //Remove all entries on the list binding                                                                                           
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                                    aTokens.forEach(token => {                                                                                                                                                                                                 
                                        //Add a new Serial number to the List Binding&nbsp;                                                                                                                                                                    
                                        serialNumbersListBinding.create({ PurchasingDocumentNumber: oGoodMovementContext.getProperty("PurchasingDocumentNumber"),                                                                                              
                                                                          ItemNumber: oGoodMovementContext.getProperty("ItemNumber"),                                                                                                                          
                                                                          Number: token.getKey() });&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs+
p;&nbsp;&nbsp;                                                                                                                                                                                                                                                 
                                    });                                                                                                                                                                                                                        
                                });                                                                                                                                                                                                                            
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                               
                                this.removeAllMessages();                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                                await this.getDataServices().submitChanges({ model: this.getModel(),&nbsp;                                                                                                                                                     
                                                                             idGroup : "good_receipt",&nbsp;                                                                                                                                                   
                                                                             busyControl: this.getView() });                                                                                                                                                   
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                                this.displayMessageToastSuccess(this.getResourceText("msg.goodreceipt.sucess", null));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                           
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                            } catch (error) {                                                                                                                                                                                                                  
                                this.displayMessageToastDanger(this.getResourceText("msg.goodreceipt.error", null));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                         
                            } finally {&nbsp;                                                                                                                                                                                                                  
                                //Reload PO Items data to get last values of remaining quantities&nbsp;                                                                                                                                                        
                                aItems.forEach(item=>{                                                                                                                                                                                                         
                                    this.getDataServices().readObjectPromise({ model: this.getModel(),                                                                                                                                                         
                                                                               path: item.getBindingContext("POItem").getPath(),                                                                                                                               
                                                                               forceReload: true });&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs+
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                                 
                                });&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                            
                                this.openMessagePopover();                                                                                                                                                                                                     
                            }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                            
                        }                                                                                                                                                                                                                                      
                    }                                                                                                                                                                                                                                          
                });&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                
            },                                                                                                                                                                                                                                                 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            /**                                                                                                                                                                                                                                                
             * Generate a navigation hash based on the Material Document details and navigate to an external app.                                                                                                                                              
             *                                                                                                                                                                                                                                                 
             * @param {object} oEvent - the event object triggering the function                                                                                                                                                                               
             */                                                                                                                                                                                                                                                
            onMatDoccumentPress: function (oEvent) {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                           
                const oGoodMovementContext = oEvent.getSource()?.getBindingContext();                                                                                                                                                                          
                if(oGoodMovementContext==null) return;                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                let sMaterialDocument = oGoodMovementContext.getProperty("MaterialDocument");                                                                                                                                                                  
                let sMaterialDocumentYear = oGoodMovementContext.getProperty("MaterialDocumentYear");                                                                                                                                                          
                                                                                                                                                                                                                                                               
                //Build navigation hash to the external app (Semantic object = MaterialMovement, Action = displayList)                                                                                                                                         
                let sHash = "#MaterialMovement-displayList&"                                                                                                                                                                                                   
                          + `/F_Mmim_Findmatdoc(MaterialDocument='${sMaterialDocument}',MaterialDocumentYear='${sMaterialDocumentYear}',MaterialDocumentItem='0001',StockChangeType='05',StockChangeContext='')`;                                              
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                               
                //const oCrossAppNavigator = sap.ushell.Container?.getService("CrossApplicationNavigation");&nbsp;                                                                                                                                             
                //oCrossAppNavigator?.toExternal({ target: { shellHash: sHash } });&nbsp;&nbsp;&nbsp;                                                                                                                                                          
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
                //Open the external app in a new window                                                                                                                                                                                                        
                let url = window.location.href.split('#')[0] + sHash;                                                                                                                                                                                          
                sap.m.URLHelper.redirect(url, true);                                                                                                                                                                                                           
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            /**                                                                                                                                                                                                                                                
             * Action remove movement                                                                                                                                                                                                                          
             * @param {*} oEvent&nbsp;                                                                                                                                                                                                                         
             */                                                                                                                                                                                                                                                
            onRemoveMovement: function(oEvent){                                                                                                                                                                                                                
                const oItem = oEvent.getSource()?.getParent();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                 
                this.byId("MovementsTable")?.removeItem(oItem); //Remove item from table                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                const oGoodMovementContext = oEvent.getSource()?.getBindingContext();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                          
                if(oGoodMovementContext?.created()!==undefined){ //If GoodMovement not already created in the back end --> remove it from model                                                                                                                
                    oGoodMovementContext?.delete(); //GoodMovement entry&nbsp;                                                                                                                                                                                 
                }                                                                                                                                                                                                                                              
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            /**                                                                                                                                                                                                                                                
             * Cancel and go back to ItelList view                                                                                                                                                                                                             
             * @param {*} oEvent&nbsp;                                                                                                                                                                                                                         
             */                                                                                                                                                                                                                                                
            onCancel: function(oEvent){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                        
                this.byId("MovementsTable")?.destroyItems();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                   
                this.getModel().resetChanges(null, true, true);&nbsp;                                                                                                                                                                                          
                this.getRouter().navTo("RouteItemsList", null,null,true);                                                                                                                                                                                      
                this.getOwnerComponent().setSelectionChanged(true);                                                                                                                                                                                            
            }                                                                                                                                                                                                                                                  
        });                                                                                                                                                                                                                                                    
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               